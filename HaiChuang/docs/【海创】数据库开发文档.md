# 海创数据库开发文档



### 海创用户表    hc_user

```bash

+--------------+---------------------+------+-----+---------+----------------+
| Field        | Type                | Null | Key | Default | Extra          |
+--------------+---------------------+------+-----+---------+----------------+
| id           | bigint(20) unsigned | NO   | PRI | NULL    | auto_increment |
| uid          | varchar(32)         | NO   | UNI | NULL    |                |
| phone        | varchar(255)        | NO   |     | NULL    |                |
| username     | varchar(32)         | NO   |     | NULL    |                |
| gender       | varchar(255)        | NO   |     | NULL    |                |
| age          | varchar(255)        | NO   |     | NULL    |                |
| birth        | varchar(255)        | NO   |     | NULL    |                |
| head_image   | varchar(255)        | YES  |     | NULL    |                |
| loc          | varchar(255)        | NO   |     | NULL    |                |
| graduate     | varchar(255)        | NO   |     | NULL    |                |
| user_session | varchar(255)        | NO   |     | NULL    |                |
+--------------+---------------------+------+-----+---------+----------------+

```



### 海创活动表   hc_activity

```bash

+------------+---------------------+------+-----+---------+----------------+
| Field      | Type                | Null | Key | Default | Extra          |
+------------+---------------------+------+-----+---------+----------------+
| id         | bigint(20) unsigned | NO   | PRI | NULL    | auto_increment |
| uid        | varchar(32)         | NO   | UNI | NULL    |                |
| actname    | varchar(32)         | NO   |     | NULL    |                |
| tags       | varchar(32)         | YES  |     | NULL    |                |
| act_detail | varchar(255)        | YES  |     | NULL    |                |
| act_time   | datetime            | YES  |     | NULL    |                |
| loc        | varchar(255)        | YES  |     | NULL    |                |
| people     | int(11)             | YES  |     | NULL    |                |
| posters    | mediumblob          | YES  |     | NULL    |                |
+------------+---------------------+------+-----+---------+----------------+
```



### 海创活动报名表   hc_activity_sign

```bash
+---------+-------------+------+-----+---------+----------------+
| Field   | Type        | Null | Key | Default | Extra          |
+---------+-------------+------+-----+---------+----------------+
| id      | bigint(20)  | NO   | PRI | NULL    | auto_increment |
| act_id  | varchar(32) | NO   |     | NULL    |                |
| usr_id  | varchar(32) | NO   |     | NULL    |                |
| is_sign | tinyint(1)  | YES  |     | 0       |                |
| is_show | tinyint(1)  | YES  |     | 0       |                |
+---------+-------------+------+-----+---------+----------------+

```

> 建表SOL：
>
> ```sql
> create table hc_activity_sign (
> id bigint(20) not null auto_increment primary key,
> act_id varchar(32) not null,
> usr_id varchar(32) not null,
> is_sign boolean default 0,
> is_show boolean default 0)comment = "报名表";
> ```

### 海创用户关注粉丝表

> 建表SOL：
>
> ```sql
> create table hc_fans (
> id bigint(20) not null auto_increment primary key,
> usr_id varchar(32) not null,
> usr_name varchar(32) not null,
> fans_id varchar(32) not null,
> fans_name varchar(32) not null)comment = "关注粉丝表";
> ```





# 测试常用sql语句

### 增加一个用户

> - 测试用户使用1000X作为uid
> - 属性使用"test_{属性名}\_{用户名}"


```sql
INSERT INTO hc_user (user_session,head_image,username,phone,gender,age,birth,loc,graduate,uid) VALUES ('test_session_tony','test_head_image_tony','Tony','13312345678','male','18',"2002-01-01","xi'an","MCU","HC_USR_10001");
```

### 增加粉丝

> - 测试用户使用1000X作为uid
> - 属性使用"test_{属性名}\_{用户名}"


```sql
INSERT INTO hc_fans (usr_id, usr_name, fans_id, fans_name, user_session, fans_session) VALUES ("HC_USR_10001","Tony","HC_USR_10002","Steve", "test_user_session_tony", "test_user_session_steven");
```

### 更新X表的Y字段为Z
```sql
UPDATE {X} SET {Y}={Z} WHERE {条件};
```


# 测试用例sql

> 获取用户tony的粉丝及头像及关注关系
>
> ```sql
>  select a.fans_name, a.fans_session, b.head_image from (select user_session, fans_name, fans_session from hc_fans where user_session="test_user_session_tony") a inner join hc_user b on a.fans_session = b.user_session;
> ```
>
> 

> 获取用户报名的活动
>
> ```mysql
> select id, uid, actname, act_time, act_detail, posters from (hc_activity as a inner join
> (select  act_id, usr_session from hc_activity_sign where usr_session="090e54a81a91aa89172202a90c1f2ba6") as b on
> a.uid=b.act_id) where DATE_FORMAT(act_time,"%Y-%m-%d") > "2020-11-19";
> ```
>
> 